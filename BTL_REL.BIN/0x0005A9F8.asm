0x0005A9F8(combatId) {
  combatHead = load(0x134D4C)
  entityId = load(combatHead + 0x66C + combatId) * 4
  entityPtr = load(0x12F344 + entityId)
  combatPtr = combatHead + combatId * 0x168
  
  // set/unset an unknown flag, probably "is colliding"
  if(entityCheckCollision(0, entityPtr, 280, 200) != -1)
    store(entityPtr + 0x30, load(entityPtr + 0x30) | 0x02)
  else
    store(entityPtr + 0x30, load(entityPtr + 0x30) & 0x05)
  
  // no AI flag, unknown, unknown
  if(load(0x134D74) != 0 && load(0x134D60) == entityPtr && load(0x135080) > 0)
    return
  
  if(load(combatPtr + 0x34) & 0x28 == 0x28) { // flattened and attacking
    flatAttackTimer = load(combatPtr + 0x24) - 1
    store(combatPtr + 0x24, flatAttackTimer)
    
    if(flatAttackTimer == 0)
      store(entityPtr + 0x30, load(entityPtr + 0x30) & 0x00FE) // unknown flag
    else if(flatAttackTimer == 10)
      store(entityPtr + 0x36, 0) // unknown
    else if(flatAttackTimer == 28)
      fireFlattenProjectile(entityPtr) // fire flatten projectile?
  }
  
  if(load(entityPtr + 0x30) & 1 != 0)
    return
  
  if(load(0x134D60) == entityPtr) {
    store(0x134D74, 0)
    store(0x134D60, 0)
  }
  
  store(combatPtr + 0x3B, 0) // unknown value
  
  // increase stat, set cooldown, add finisher value
  if(load(combatPtr + 0x34) & 0x0020 != 0) {
    if(combatId == 0)
      store(combatHead + 0x640, load(combatHead + 0x640) + 1) // hit count
    
    store(combatPtr + 0x34, load(combatPtr + 0x34) & 0xFBFF) // unset unknown flag
    store(combatPtr + 0x34, load(combatPtr + 0x34) | 0x1000) // set on cooldown
    store(combatPtr + 0x28, 40) // cooldown timer
    
    addFinisherValue(combatPtr, load(combatPtr + 0x18) * 0.04) // finisher goal
  }
  
  // 
  if(load(combatPtr + 0x26) <= 0) {
    if(load(combatPtr + 0x34) & 0x0008 != 0) // is flattened
      store(entityPtr + 0x36, 0) // unknown
    
    if(load(combatPtr + 0x34) & 0x0020 == 0) // is attacking
      store(entityPtr + 0x53, 0) // unknown
      
    flag = load(combatPtr + 0x34)
    
    if(flag & 0x0080 != 0) { // if blocking
      store(combatPtr + 0x34, flag & 0xFF7F) // unset blocking flag
      clearBlockingData(combatPtr)
    }
    else
      store(combatPtr + 0x34, flag & 0xFF0F) // unset blocking, attacking, transforming, knocked back flag
  }
  
  if(load(combatPtr + 0x34) & 0x0010 == 0) { // is knocked back
    if(load(combatPtr + 0x22) == -1)
      store(combatPtr + 0x22, 0x41) // flatten timer?
  }
  else {
    store(combatPtr + 0x2A, 0) // dumb timer
    store(combatPtr + 0x34, load(combatPtr + 0x34) & 0xDFFF) // unset stupid
  }
}

0x0005a9f8 addiu sp,sp,0xffe0
0x0005a9fc sw ra,0x001c(sp)
0x0005aa00 sw s2,0x0018(sp)
0x0005aa04 sw s1,0x0014(sp)
0x0005aa08 lw v0,-0x6de0(gp)
0x0005aa0c addu s2,a0,r0
0x0005aa10 addu a0,v0,r0
0x0005aa14 sw s0,0x0010(sp)
0x0005aa18 addu v0,s2,v0
0x0005aa1c lbu v0,0x066c(v0)
0x0005aa20 addiu a2,r0,0x0118
0x0005aa24 sll v1,v0,0x02
0x0005aa28 lui v0,0x8013
0x0005aa2c addiu v0,v0,0xf344
0x0005aa30 addu v0,v0,v1
0x0005aa34 lw s1,0x0000(v0)
0x0005aa38 addiu a3,r0,0x00c8
0x0005aa3c sll v0,s2,0x04
0x0005aa40 sub v1,v0,s2
0x0005aa44 sll v0,v1,0x02
0x0005aa48 sub v0,v0,v1
0x0005aa4c sll v0,v0,0x03
0x0005aa50 addu s0,a0,v0
0x0005aa54 addu a0,r0,r0
0x0005aa58 jal 0x000d45ec
0x0005aa5c addu a1,s1,r0
0x0005aa60 addiu asmTemp,r0,0xffff
0x0005aa64 beq v0,asmTemp,0x0005aa80
0x0005aa68 nop
0x0005aa6c lbu v0,0x0030(s1)
0x0005aa70 nop
0x0005aa74 ori v0,v0,0x0002
0x0005aa78 beq r0,r0,0x0005aa90
0x0005aa7c sb v0,0x0030(s1)
0x0005aa80 lbu v0,0x0030(s1)
0x0005aa84 nop
0x0005aa88 andi v0,v0,0x0005
0x0005aa8c sb v0,0x0030(s1)
0x0005aa90 lw v0,-0x6db8(gp)
0x0005aa94 nop
0x0005aa98 beq v0,r0,0x0005aac0
0x0005aa9c nop
0x0005aaa0 lw v0,-0x6dcc(gp)
0x0005aaa4 nop
0x0005aaa8 bne v0,s1,0x0005aac0
0x0005aaac nop
0x0005aab0 lw v0,-0x6aac(gp)
0x0005aab4 nop
0x0005aab8 bgtz v0,0x0005acac
0x0005aabc nop
0x0005aac0 lhu v0,0x0034(s0)
0x0005aac4 addiu asmTemp,r0,0x0028
0x0005aac8 andi v0,v0,0x0028
0x0005aacc bne v0,asmTemp,0x0005ab34
0x0005aad0 nop
0x0005aad4 lh v0,0x0024(s0)
0x0005aad8 nop
0x0005aadc addi v0,v0,-0x0001
0x0005aae0 sh v0,0x0024(s0)
0x0005aae4 lh v0,0x0024(s0)
0x0005aae8 nop
0x0005aaec beq v0,r0,0x0005ab24
0x0005aaf0 nop
0x0005aaf4 addiu asmTemp,r0,0x000a
0x0005aaf8 beq v0,asmTemp,0x0005ab1c
0x0005aafc nop
0x0005ab00 addiu asmTemp,r0,0x001c
0x0005ab04 bne v0,asmTemp,0x0005ab34
0x0005ab08 nop
0x0005ab0c jal 0x00071098
0x0005ab10 addu a0,s1,r0
0x0005ab14 beq r0,r0,0x0005ab38
0x0005ab18 lbu v0,0x0030(s1)
0x0005ab1c beq r0,r0,0x0005ab34
0x0005ab20 sb r0,0x0036(s1)
0x0005ab24 lbu v0,0x0030(s1)
0x0005ab28 nop
0x0005ab2c andi v0,v0,0x00fe
0x0005ab30 sb v0,0x0030(s1)
0x0005ab34 lbu v0,0x0030(s1)
0x0005ab38 nop
0x0005ab3c andi v0,v0,0x0001
0x0005ab40 bne v0,r0,0x0005acac
0x0005ab44 nop
0x0005ab48 lw v0,-0x6dcc(gp)
0x0005ab4c nop
0x0005ab50 bne v0,s1,0x0005ab60
0x0005ab54 nop
0x0005ab58 sw r0,-0x6db8(gp)
0x0005ab5c sw r0,-0x6dcc(gp)
0x0005ab60 sb r0,0x003b(s0)
0x0005ab64 lhu v0,0x0034(s0)
0x0005ab68 nop
0x0005ab6c andi v0,v0,0x0020
0x0005ab70 beq v0,r0,0x0005abf4
0x0005ab74 nop
0x0005ab78 bne s2,r0,0x0005ab98
0x0005ab7c nop
0x0005ab80 lw v1,-0x6de0(gp)
0x0005ab84 nop
0x0005ab88 lhu v0,0x0640(v1)
0x0005ab8c nop
0x0005ab90 addiu v0,v0,0x0001
0x0005ab94 sh v0,0x0640(v1)
0x0005ab98 lhu v0,0x0034(s0)
0x0005ab9c addu a0,s0,r0
0x0005aba0 andi v0,v0,0xfbff
0x0005aba4 sh v0,0x0034(s0)
0x0005aba8 lhu v0,0x0034(s0)
0x0005abac nop
0x0005abb0 ori v0,v0,0x1000
0x0005abb4 sh v0,0x0034(s0)
0x0005abb8 addiu v0,r0,0x0028
0x0005abbc sh v0,0x0028(s0)
0x0005abc0 lh v0,0x0018(s0)
0x0005abc4 nop
0x0005abc8 sll v1,v0,0x01
0x0005abcc lui v0,0x51eb
0x0005abd0 ori v0,v0,0x851f
0x0005abd4 mult v0,v1
0x0005abd8 mfhi v0
0x0005abdc srl v1,v1,0x1f
0x0005abe0 sra v0,v0,0x04
0x0005abe4 addu v0,v0,v1
0x0005abe8 sll a1,v0,0x10
0x0005abec jal 0x0005dfc8
0x0005abf0 sra a1,a1,0x10
0x0005abf4 lh v0,0x0026(s0)
0x0005abf8 nop
0x0005abfc bgtz v0,0x0005ac68
0x0005ac00 nop
0x0005ac04 lhu v0,0x0034(s0)
0x0005ac08 nop
0x0005ac0c andi v0,v0,0x0008
0x0005ac10 beq v0,r0,0x0005ac1c
0x0005ac14 nop
0x0005ac18 sb r0,0x0036(s1)
0x0005ac1c lhu v0,0x0034(s0)
0x0005ac20 nop
0x0005ac24 andi v0,v0,0x0020
0x0005ac28 bne v0,r0,0x0005ac34
0x0005ac2c nop
0x0005ac30 sb r0,0x0053(s1)
0x0005ac34 lhu v1,0x0034(s0)
0x0005ac38 nop
0x0005ac3c andi v0,v1,0x0080
0x0005ac40 beq v0,r0,0x0005ac60
0x0005ac44 nop
0x0005ac48 andi v0,v1,0xff7f
0x0005ac4c sh v0,0x0034(s0)
0x0005ac50 jal 0x0005b254
0x0005ac54 addu a0,s0,r0
0x0005ac58 beq r0,r0,0x0005ac6c
0x0005ac5c lhu v0,0x0034(s0)
0x0005ac60 andi v0,v1,0xff0f
0x0005ac64 sh v0,0x0034(s0)
0x0005ac68 lhu v0,0x0034(s0)
0x0005ac6c nop
0x0005ac70 andi v0,v0,0x0010
0x0005ac74 bne v0,r0,0x0005ac98
0x0005ac78 nop
0x0005ac7c lh v0,0x0022(s0)
0x0005ac80 addiu asmTemp,r0,0xffff
0x0005ac84 bne v0,asmTemp,0x0005acac
0x0005ac88 nop
0x0005ac8c addiu v0,r0,0x0041
0x0005ac90 beq r0,r0,0x0005acac
0x0005ac94 sh v0,0x0022(s0)
0x0005ac98 sh r0,0x002a(s0)
0x0005ac9c lhu v0,0x0034(s0)
0x0005aca0 nop
0x0005aca4 andi v0,v0,0xdfff
0x0005aca8 sh v0,0x0034(s0)
0x0005acac lw ra,0x001c(sp)
0x0005acb0 lw s2,0x0018(sp)
0x0005acb4 lw s1,0x0014(sp)
0x0005acb8 lw s0,0x0010(sp)
0x0005acbc jr ra
0x0005acc0 addiu sp,sp,0x0020